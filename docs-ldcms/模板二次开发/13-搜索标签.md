# 搜索标签

> 用于执行站内搜索功能，对应搜索文档内容的标题
> 搜索列表对应模板文件中的"search.html"文件

## 搜索表单使用示例

```html
<form method="get" action="{:addon_url('ldcms/search/index')}">
    //必须要
    <input name="search" type="text" placeholder="搜索是种美德">
    //不是必须 TAG
    <input name="tags" type="hidden" value="tag1,tag2">
    //不是必须 指定栏目 ID
    <input name="cid" type="hidden" value="1,2">
    //默认是search.html，如果不是这个模板页面，可以指定
    <input name="searchtpl" type="hidden" value="search.html">
    //v1.2.0新增 //不是必须 匹配模式 1 模糊匹配 0 精确匹配
    <input name="fuzzy" type="hidden" value="1">
    //不是必须 指定模型 ID
    <input name="mid" type="hidden" value="1">
    //v1.2.0后支持搜索多个字段 用 | 隔开
    <input name="field" type="hidden" value="title|cid">
    <button><i class="fa fa-search"></i></button>
</form>
```

## 搜索结果页面使用

**在全站任意的位置，使用表单进行搜索**

```html
<!-- 关键词 -->
<p>查找 "{$search}"</p>
{ld:search }
<li data-id="{$item.id}" class="anim fadeInUp">
    <a href="{$item.url}" title="{$item.title}">
        <img src="{$item.image}" alt="{$item.title}" />
    </a>
    <a href="{$item.url}" title="{$item.title}">
        {$item.title}
    </a>
    <i>{$item.description}</i>
</li>
{/ld:search}
<!-- 调用分页 -->
<p>{$pages}</p>
<!-- 找到x条信息 -->
<p>{$pages_total}</p>
```

## 调用参数

| 参数 | 是否必填 | 说明 |
|------|----------|------|
| limit | 否 | 调用数量（不填写默认获取16条） |
| alias | 否 | 默认为"item",代表循环列表的变量名称。 |
| empty | 否 | 数列为空时显示的数据 |
| key | 否 | 列表循环键名变量,默认为i |
| mod | 否 | 取模值，常用于控制换行，默认为2 |

## 常用字段

> 如需使用其他的字段请至后台内容管理下查找对应字段
> 默认为`{$item.id}` 如果`alias`修改别名为'vo', 那么则变成`{$vo.id}`

| 字段名 | 说明 |
|--------|------|
| `{$item.url}` | 链接 |
| `{$item.title}` | 标题 |
| `{$item.image}` | 缩略图 |
| `{$item.seo_description}` | 描述 |
| `{$item.visits}` | 浏览次数 |
| `{$item.show_time}` | 发布时间 |

## 分页和统计

> 如需调用分页，则直接在`{ld:search}{/ld:search}`标签外使用`{$pages}`来获取
> 如需获取获取的信息条数，则继续在标签之后使用`{$pages_total}`来获取
> 如需在搜索结果页面调用扩展字段，则需要在`form`表单中指定模型ID`<input name="mid" type="hidden" value="1">`

## 实际应用示例

### 1. 基础搜索框
```html
<div class="search-box">
    <form method="get" action="{:addon_url('ldcms/search/index')}" class="search-form">
        <div class="search-input-group">
            <input type="text" name="search" placeholder="请输入关键词..." required>
            <button type="submit" class="search-btn">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </form>
</div>
```

### 2. 高级搜索表单
```html
<div class="advanced-search">
    <h3>高级搜索</h3>
    <form method="get" action="{:addon_url('ldcms/search/index')}" class="advanced-search-form">
        <div class="search-field">
            <label>关键词：</label>
            <input type="text" name="search" placeholder="请输入搜索关键词">
        </div>
        
        <div class="search-field">
            <label>搜索范围：</label>
            <select name="cid">
                <option value="">全部栏目</option>
                {ld:sort pid="0"}
                <option value="{$item.id}">{$item.name}</option>
                {/ld:sort}
            </select>
        </div>
        
        <div class="search-field">
            <label>内容类型：</label>
            <select name="mid">
                <option value="">全部类型</option>
                <option value="1">新闻文章</option>
                <option value="2">产品信息</option>
                <option value="3">案例展示</option>
            </select>
        </div>
        
        <div class="search-field">
            <label>匹配模式：</label>
            <select name="fuzzy">
                <option value="1">模糊匹配</option>
                <option value="0">精确匹配</option>
            </select>
        </div>
        
        <div class="search-field">
            <label>搜索字段：</label>
            <select name="field">
                <option value="title">仅标题</option>
                <option value="title|content">标题+内容</option>
                <option value="title|tag">标题+标签</option>
            </select>
        </div>
        
        <div class="search-actions">
            <button type="submit" class="btn-search">搜索</button>
            <button type="reset" class="btn-reset">重置</button>
        </div>
    </form>
</div>
```

### 3. 搜索结果页面
```html
<div class="search-results">
    <div class="search-header">
        <h2>搜索结果</h2>
        {if $search}
        <p class="search-keyword">关键词：<span>"{$search}"</span></p>
        {/if}
        <p class="search-count">找到 <strong>{$pages_total}</strong> 条相关信息</p>
    </div>
    
    <div class="results-list">
        {ld:search limit="10"}
        <div class="result-item">
            <div class="result-image">
                {if $item.image}
                <img src="{$item.image}" alt="{$item.title}">
                {else}
                <div class="no-image">暂无图片</div>
                {/if}
            </div>
            <div class="result-content">
                <h3 class="result-title">
                    <a href="{$item.url}" title="{$item.title}">{$item.title}</a>
                </h3>
                <p class="result-description">{$item.seo_description}</p>
                <div class="result-meta">
                    <span class="result-time">{$item.show_time|date="Y-m-d",###}</span>
                    <span class="result-visits">浏览：{$item.visits}次</span>
                    <span class="result-category">{$item.cname}</span>
                </div>
            </div>
        </div>
        {else}
        <div class="no-results">
            <i class="fas fa-search"></i>
            <h3>没有找到相关内容</h3>
            <p>请尝试其他关键词或调整搜索条件</p>
        </div>
        {/ld:search}
    </div>
    
    {if $pages}
    <div class="search-pagination">
        {$pages}
    </div>
    {/if}
</div>
```

### 4. 实时搜索建议
```html
<div class="live-search">
    <div class="search-input-wrapper">
        <input type="text" id="liveSearch" placeholder="输入关键词实时搜索...">
        <div class="search-suggestions" id="suggestions"></div>
    </div>
</div>

<script>
$(document).ready(function() {
    let searchTimeout;
    
    $('#liveSearch').on('input', function() {
        const keyword = $(this).val().trim();
        
        clearTimeout(searchTimeout);
        
        if (keyword.length >= 2) {
            searchTimeout = setTimeout(function() {
                $.get('{:addon_url("ldcms/search/suggest")}', {
                    keyword: keyword,
                    limit: 8
                }, function(data) {
                    displaySuggestions(data);
                });
            }, 300);
        } else {
            $('#suggestions').hide();
        }
    });
    
    function displaySuggestions(data) {
        let html = '';
        if (data.length > 0) {
            data.forEach(function(item) {
                html += `<div class="suggestion-item" data-url="${item.url}">
                    <span class="suggestion-title">${item.title}</span>
                    <span class="suggestion-category">${item.category}</span>
                </div>`;
            });
            $('#suggestions').html(html).show();
        } else {
            $('#suggestions').hide();
        }
    }
    
    $(document).on('click', '.suggestion-item', function() {
        window.location.href = $(this).data('url');
    });
});
</script>
```

### 5. 移动端搜索
```html
<div class="mobile-search">
    <div class="search-trigger" onclick="openSearch()">
        <i class="fas fa-search"></i>
        <span>搜索</span>
    </div>
    
    <div class="search-overlay" id="searchOverlay">
        <div class="search-container">
            <div class="search-header">
                <h3>搜索</h3>
                <button class="close-search" onclick="closeSearch()">×</button>
            </div>
            
            <form method="get" action="{:addon_url('ldcms/search/index')}">
                <div class="mobile-search-input">
                    <input type="text" name="search" placeholder="请输入搜索关键词" autofocus>
                    <button type="submit">搜索</button>
                </div>
                
                <div class="search-filters">
                    <h4>搜索范围</h4>
                    <div class="filter-options">
                        <label><input type="radio" name="cid" value="">全部</label>
                        <label><input type="radio" name="cid" value="1">新闻</label>
                        <label><input type="radio" name="cid" value="2">产品</label>
                        <label><input type="radio" name="cid" value="3">案例</label>
                    </div>
                </div>
            </form>
            
            <div class="recent-searches">
                <h4>最近搜索</h4>
                <div class="recent-keywords">
                    <span class="recent-keyword">智能手机</span>
                    <span class="recent-keyword">新品发布</span>
                    <span class="recent-keyword">技术方案</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function openSearch() {
    document.getElementById('searchOverlay').style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

function closeSearch() {
    document.getElementById('searchOverlay').style.display = 'none';
    document.body.style.overflow = 'auto';
}
</script>
```

## CSS样式参考

```css
/* 基础搜索样式 */
.search-box {
    max-width: 500px;
    margin: 20px auto;
}

.search-input-group {
    display: flex;
    border: 2px solid #e9ecef;
    border-radius: 25px;
    overflow: hidden;
    background: white;
}

.search-input-group input {
    flex: 1;
    padding: 12px 20px;
    border: none;
    outline: none;
    font-size: 16px;
}

.search-btn {
    padding: 12px 20px;
    background: #007bff;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s;
}

.search-btn:hover {
    background: #0056b3;
}

/* 搜索结果样式 */
.result-item {
    display: flex;
    padding: 20px;
    border-bottom: 1px solid #eee;
    transition: background-color 0.3s;
}

.result-item:hover {
    background-color: #f8f9fa;
}

.result-image {
    width: 120px;
    height: 80px;
    margin-right: 15px;
    flex-shrink: 0;
}

.result-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

.result-content {
    flex: 1;
}

.result-title a {
    color: #007bff;
    text-decoration: none;
    font-size: 18px;
    font-weight: 500;
}

.result-title a:hover {
    text-decoration: underline;
}

.result-description {
    color: #666;
    margin: 8px 0;
    line-height: 1.5;
}

.result-meta {
    font-size: 14px;
    color: #999;
}

.result-meta span {
    margin-right: 15px;
}

/* 移动端搜索样式 */
.search-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 9999;
    align-items: flex-start;
    justify-content: center;
    padding-top: 20px;
}

.search-container {
    background: white;
    width: 90%;
    max-width: 500px;
    border-radius: 8px;
    max-height: 80vh;
    overflow-y: auto;
}

.search-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
}

.close-search {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #999;
}

.mobile-search-input {
    padding: 20px;
}

.mobile-search-input input {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-bottom: 10px;
}

.mobile-search-input button {
    width: 100%;
    padding: 12px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
}

@media (max-width: 768px) {
    .result-item {
        flex-direction: column;
    }
    
    .result-image {
        width: 100%;
        height: 200px;
        margin-right: 0;
        margin-bottom: 10px;
    }
}
```

---

*文档最后更新时间：2024-04-03 15:10:08*
*著作权归应用插件开发者所有，未经许可，禁止转载、复制此文档的任何内容。*